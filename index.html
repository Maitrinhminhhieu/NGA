<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Happy Birthday ‚Äì Thanh Nga</title>
  <style>
    :root {
      --glass-bg: rgba(255, 255, 255, 0.18);
      --glass-border: rgba(255, 255, 255, 0.55);
      --glass-soft: rgba(255, 255, 255, 0.12);

      --accent: #ff9fc5;
      --accent-2: #ffd889;
      --accent-blue: #bfe7ff;

      --text-main: #2b1a33;
      --text-soft: #4d3555;
      --text-soft-light: #7b5b8b;

      --error: #ff4b4b;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Helvetica Neue", Arial, sans-serif;
      min-height: 100vh;
      color: var(--text-main);
      background:
        radial-gradient(circle at 0% 0%, #ffe9f3 0%, #fff4fb 20%, #fff7e0 40%, #e4f6ff 70%, #f1ecff 100%);
      overflow: hidden;
    }

    /* Canvas n·ªÅn pastel */
    #bg-canvas {
      position: fixed;
      inset: 0;
      z-index: -4;
      pointer-events: none;
    }

    /* Background pastel blobs */
    .app-bg {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at 12% 18%, rgba(255, 214, 236, 0.9), transparent 55%),
        radial-gradient(circle at 82% 15%, rgba(224, 245, 255, 0.9), transparent 55%),
        radial-gradient(circle at 20% 82%, rgba(255, 239, 201, 0.9), transparent 55%),
        radial-gradient(circle at 78% 80%, rgba(239, 217, 255, 0.92), transparent 55%);
      mix-blend-mode: screen;
      filter: blur(10px);
      z-index: -2;
      animation: bgFloat 18s infinite alternate ease-in-out;
    }

    .bg-orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(18px);
      opacity: 0.9;
      z-index: -3;
    }

    .bg-orb.orb-1 {
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, rgba(255, 177, 210, 0.75), transparent 60%);
      top: -40px;
      left: -40px;
    }

    .bg-orb.orb-2 {
      width: 280px;
      height: 280px;
      background: radial-gradient(circle, rgba(191, 231, 255, 0.8), transparent 60%);
      right: -60px;
      bottom: -20px;
    }

    .bg-orb.orb-3 {
      width: 220px;
      height: 220px;
      background: radial-gradient(circle, rgba(255, 231, 185, 0.85), transparent 60%);
      bottom: 28%;
      left: 10%;
    }

    @keyframes bgFloat {
      0% { transform: translate3d(0, 0, 0) scale(1); }
      50% { transform: translate3d(0, -10px, 0) scale(1.03); }
      100% { transform: translate3d(0, 10px, 0) scale(1.01); }
    }

    .app {
      position: relative;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px;
      overflow: hidden;
    }

    .glass-panel {
      background:
        linear-gradient(145deg,
          rgba(255, 255, 255, 0.9),
          rgba(255, 255, 255, 0.82));
      border-radius: 26px;
      border: 1px solid var(--glass-border);
      box-shadow:
        0 24px 60px rgba(196, 171, 206, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(30px) saturate(1.8);
      -webkit-backdrop-filter: blur(30px) saturate(1.8);
    }

    .screen {
      position: relative;
      width: 100%;
      max-width: 430px;
      min-height: 480px;
      max-height: calc(100vh - 32px);
      padding: 24px 20px 64px;
      display: none;
      flex-direction: column;
      text-align: center;
      overflow-y: auto;
      scrollbar-width: none;
      opacity: 0;
      transform: translateY(26px) scale(0.97);
    }

    .screen::-webkit-scrollbar {
      display: none;
    }

    .screen.active {
      display: flex;
      animation: screenIn 0.55s ease-out forwards;
    }

    @keyframes screenIn {
      0% { opacity: 0; transform: translateY(26px) scale(0.97); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }

    h1, h2, h3 {
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    h1 { font-size: 1.6rem; margin-bottom: 12px; }

    p {
      font-size: 0.96rem;
      line-height: 1.6;
      color: var(--text-soft);
    }

    input, button {
      font-family: inherit;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 12px 22px;
      font-size: 0.95rem;
      cursor: pointer;
      font-weight: 600;
      background:
        radial-gradient(circle at 0% 0%, rgba(255,255,255,0.6), transparent 45%),
        linear-gradient(135deg, #ffd88f, #ff9fc5);
      color: #2c1630;
      box-shadow:
        0 12px 28px rgba(201, 154, 196, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.8);
      transition: transform 0.16s ease, box-shadow 0.16s ease, filter 0.16s ease;
    }

    .btn:hover {
      transform: translateY(-1px) scale(1.02);
      box-shadow:
        0 16px 38px rgba(186, 135, 184, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.9);
      filter: brightness(1.03);
    }

    .btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow:
        0 9px 22px rgba(180, 132, 180, 0.7),
        0 0 0 1px rgba(255, 255, 255, 0.9);
      filter: brightness(0.97);
    }

    .btn-ghost {
      border-radius: 999px;
      padding: 10px 20px;
      border: 1px solid rgba(255, 158, 197, 0.9);
      background:
        radial-gradient(circle at 0% 0%, rgba(255,255,255,0.7), transparent 45%),
        linear-gradient(135deg, rgba(255, 231, 250, 0.95), rgba(255, 240, 255, 0.96));
      color: #4b294f;
      font-size: 0.8rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      box-shadow:
        0 14px 30px rgba(214, 176, 207, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.9);
      transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease, opacity 0.18s ease;
    }

    .btn-ghost::before {
      content: "";
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent-2);
      box-shadow: 0 0 10px rgba(255, 195, 110, 1);
    }

    .btn-ghost:hover {
      transform: translateY(-1px) scale(1.03);
      box-shadow:
        0 18px 40px rgba(210, 165, 207, 1),
        0 0 0 1px rgba(255, 255, 255, 1);
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(255, 158, 197, 0.9);
      color: #7b436b;
      margin-bottom: 12px;
    }

    .tag-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 12px rgba(255, 158, 197, 0.98);
    }

    .mt-8 { margin-top: 8px; }
    .mt-16 { margin-top: 16px; }
    .mt-20 { margin-top: 20px; }
    .mt-24 { margin-top: 24px; }
    .mt-auto { margin-top: auto; }

    .hint {
      font-size: 0.76rem;
      color: var(--text-soft-light);
      margin-top: 8px;
      text-align: left;
    }

    .error {
      margin-top: 6px;
      font-size: 0.8rem;
      color: var(--error);
      min-height: 16px;
      text-align: left;
    }

    /* LOGIN */
    .login-top {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      margin-bottom: 10px;
    }

    .lock-emoji {
      font-size: 2rem;
      animation: floatAvatar 3.2s ease-in-out infinite;
    }

    .login-title {
      font-size: 0.95rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--text-main);
    }

    .login-sub {
      font-size: 0.88rem;
      color: var(--text-soft-light);
    }

    .login-avatar {
      width: 84px;
      height: 84px;
      border-radius: 50%;
      margin: 12px auto 14px;
      background:
        conic-gradient(from 40deg, #ffe6f3, #fffbe3, #e9f6ff, #ffe6f3);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      box-shadow:
        0 14px 32px rgba(197, 154, 196, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.9);
      animation: floatAvatar 3.4s ease-in-out infinite;
    }

    .login-avatar-inner {
      width: 90%;
      height: 90%;
      border-radius: 50%;
      background:
        radial-gradient(circle at 30% 0%, #ffffff, #f6c7e5);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #813760;
      font-weight: 700;
      font-size: 1.4rem;
      text-shadow: 0 3px 10px rgba(255, 255, 255, 0.7);
    }

    @keyframes floatAvatar {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 14px;
    }

    label {
      font-size: 0.8rem;
      text-align: left;
      color: var(--text-soft);
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .input-shell {
      position: relative;
      border-radius: 999px;
      background:
        radial-gradient(circle at 0% 0%, rgba(255, 255, 255, 0.95), transparent 50%),
        linear-gradient(145deg, #ffe9f6, #fffafc);
      border: 1px solid rgba(255, 177, 210, 0.95);
      padding: 3px 14px;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow:
        0 10px 22px rgba(197, 154, 196, 0.6),
        0 0 0 1px rgba(255, 255, 255, 0.9);
      transition: box-shadow 0.25s ease, transform 0.25s ease, border-color 0.25s ease;
    }

    .input-shell input {
      flex: 1;
      border: none;
      outline: none;
      background: transparent;
      padding: 10px 0;
      color: var(--text-main);
      font-size: 0.95rem;
    }

    .input-shell input::placeholder {
      color: rgba(150, 125, 150, 0.7);
    }

    .input-shell span.prefix {
      font-size: 0.9rem;
      color: rgba(126, 96, 126, 0.9);
    }

    .input-shell.focused {
      border-color: var(--accent-2);
      box-shadow:
        0 14px 30px rgba(212, 165, 191, 0.9),
        0 0 16px rgba(255, 200, 140, 1);
      transform: translateY(-1px);
    }

    .password-wrapper {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transform: translateY(10px) scale(0.98);
      transition: max-height 0.4s ease, opacity 0.4s ease, transform 0.4s ease;
    }

    .password-wrapper.visible {
      max-height: 140px;
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .login-btn-wrapper {
      margin-top: 18px;
      opacity: 0;
      transform: translateY(10px) scale(0.98);
      transition: opacity 0.35s ease, transform 0.35s ease;
    }

    .login-btn-wrapper.visible {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    /* HELLO SCREEN */
    #screen-hello {
      align-items: center;
      justify-content: center;
    }

    #hello-typing {
      font-size: 2.4rem;
      font-weight: 700;
      letter-spacing: 0.14em;
      text-align: center;
      min-height: 3.1em;
      margin-top: auto;
      margin-bottom: auto;
      line-height: 1.1;
      color: var(--text-main);
      text-shadow:
        0 0 10px rgba(255, 255, 255, 0.8),
        0 0 26px rgba(197, 154, 196, 0.9);
    }

    #hello-typing br { line-height: 1.1; }

    .tap-indicator {
      margin-top: auto;
      font-size: 0.78rem;
      color: var(--text-soft-light);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      animation: bounceTap 1.25s infinite ease-in-out;
    }

    .tap-dot {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      border: 1px solid rgba(255, 158, 197, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.9);
      font-size: 1rem;
      color: #c16f9b;
      box-shadow:
        0 10px 18px rgba(206, 160, 198, 0.8),
        0 0 0 1px rgba(255, 255, 255, 1);
    }

    @keyframes bounceTap {
      0%, 100% { transform: translateY(0); opacity: 0.7; }
      50% { transform: translateY(-4px); opacity: 1; }
    }

    .fade-in {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.5s ease-out, transform 0.5s ease-out;
    }
    .fade-out {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.5s ease-out, transform 0.5s ease-out;
    }

    /* INTRO SCREEN */
    .intro-title {
      font-size: 1.05rem;
      font-weight: 700;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--text-main);
      margin-top: 8px;
      margin-bottom: 8px;
    }

    .typing {
      min-height: 84px;
      font-size: 0.96rem;
      text-align: left;
      margin-top: 14px;
    }

    .typing span.caret {
      display: inline-block;
      width: 8px;
      height: 1.05em;
      background: var(--accent-2);
      margin-left: 2px;
      animation: caretBlink 0.7s infinite;
      vertical-align: bottom;
    }

    @keyframes caretBlink {
      0%, 40% { opacity: 1; }
      60%, 100% { opacity: 0; }
    }

    /* VERIFY */
    .spinner {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 3px solid rgba(255, 200, 230, 0.7);
      border-top-color: var(--accent);
      border-right-color: var(--accent-blue);
      animation: spin 1.1s linear infinite;
      margin: 0 auto 18px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .status-text {
      font-size: 0.96rem;
      color: var(--text-soft);
    }

    .status-sub {
      margin-top: 6px;
      font-size: 0.84rem;
      color: var(--text-soft-light);
    }

    /* WARP (xoay chuy·ªÉn 10s) */
    .warp {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 16px;
      margin-top: auto;
      margin-bottom: auto;
    }

    .warp-orbit {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      border: 1px dashed rgba(199, 149, 192, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.9), transparent 65%);
    }

    .warp-orbit::before,
    .warp-orbit::after {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        conic-gradient(from 120deg,
          rgba(255, 255, 255, 0.8),
          rgba(255, 187, 216, 0.95),
          rgba(184, 230, 255, 0.95),
          rgba(255, 241, 204, 1),
          transparent,
          rgba(255, 255, 255, 1));
      mix-blend-mode: screen;
      animation: orbitSpin 3s linear infinite;
    }

    .warp-orbit::after {
      animation-direction: reverse;
      opacity: 0.7;
    }

    @keyframes orbitSpin {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }

    .warp-dot {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: radial-gradient(circle, #ffffff, #ffc0da);
      box-shadow: 0 0 28px rgba(255, 200, 230, 1);
    }

    .warp-sub {
      font-size: 0.95rem;
      color: var(--text-soft-light);
      max-width: 280px;
    }

    /* STORY */
    .section-title {
      font-size: 1.08rem;
      font-weight: 800;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      margin-bottom: 12px;
      text-align: center;
      color: var(--text-main);
      text-shadow:
        0 0 10px rgba(255, 255, 255, 0.9),
        0 0 18px rgba(219, 180, 215, 0.9);
    }

    .story-board-wrapper {
      display: flex;
      justify-content: center;
      width: 100%;
    }

    .story-board {
      margin-top: 8px;
      padding: 14px 16px 18px;
      border-radius: 18px;
      background:
        linear-gradient(145deg,
          rgba(255, 242, 251, 0.98),
          rgba(255, 250, 255, 0.98));
      border: 1px solid rgba(255, 176, 210, 0.9);
      box-shadow:
        0 18px 40px rgba(212, 166, 204, 0.9),
        0 0 0 1px rgba(255, 255, 255, 1);
      text-align: left;
      position: relative;
      display: inline-block;
      max-width: 100%;
      transform-origin: center;
      animation: cardPopIn 0.55s ease-out forwards;
    }

    .story-board::before {
      content: "";
      position: absolute;
      inset: 10px;
      border-radius: 14px;
      border: 1px dashed rgba(255, 180, 210, 0.4);
      pointer-events: none;
    }

    @keyframes cardPopIn {
      0% { opacity: 0; transform: translateY(12px) scale(0.95); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }

    .story-line {
      opacity: 1;
      margin-bottom: 10px;
      font-size: 0.94rem;
      color: var(--text-soft);
      min-height: 1.4em;
    }

    /* BIG TITLE */
    .big-birthday {
      font-size: 1.32rem;
      font-weight: 800;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      text-align: center;
      margin-top: 8px;
      margin-bottom: 12px;
      color: var(--text-main);
      text-shadow:
        0 0 10px rgba(255, 255, 255, 0.9),
        0 0 22px rgba(255, 195, 211, 1);
      animation: pulseTitle 1.7s infinite ease-in-out;
    }

    @keyframes pulseTitle {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.04); }
    }

    .blessing-card-wrapper {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-top: 10px;
    }

    .blessing-card {
      padding: 14px 16px 16px;
      border-radius: 18px;
      background:
        linear-gradient(145deg,
          rgba(255, 255, 255, 0.95),
          rgba(255, 248, 255, 0.96));
      border: 1px solid rgba(255, 196, 213, 0.9);
      box-shadow:
        0 16px 34px rgba(212, 166, 204, 0.8),
        0 0 0 1px rgba(255, 255, 255, 1);
      text-align: left;
      display: inline-block;
      max-width: 100%;
      transform-origin: center;
      animation: cardPopIn 0.5s ease-out forwards;
    }

    .blessing-line {
      opacity: 0;
      transform: translateY(12px) scale(0.98);
      transition: opacity 0.7s ease-out, transform 0.7s ease-out;
      margin-bottom: 8px;
      text-align: left;
      font-size: 0.95rem;
      color: var(--text-soft);
    }

    .blessing-line.visible {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .final-question-text {
      font-size: 0.98rem;
      margin-top: 16px;
      color: var(--text-soft);
    }

    /* FINAL PHOTO ‚Äì m·∫£nh k√≠nh + n·ªÅn WebGL */
    .photo-stage {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 18px;
      margin-top: 10px;
    }

    /* Three.js glass background */
    #glass-webgl {
      position: absolute;
      inset: -20px -20px auto -20px;
      height: 260px;
      z-index: -1;
      pointer-events: none;
      border-radius: 28px;
      overflow: hidden;
      mix-blend-mode: screen;
      opacity: 0.9;
    }

    .final-photo-frame {
      width: 100%;
      max-width: 320px;
      aspect-ratio: 4 / 3;
      border-radius: 22px;
      overflow: hidden;
      border: 1px solid rgba(255, 176, 210, 0.9);
      background:
        radial-gradient(circle at 0% 0%, rgba(255,255,255,1), transparent 55%),
        linear-gradient(145deg, #ffeaf5, #fff7fb);
      box-shadow:
        0 18px 44px rgba(212, 166, 204, 0.95),
        0 0 0 1px rgba(255, 255, 255, 1);
      position: relative;
      transform-origin: center;
      animation: cardPopIn 0.6s ease-out forwards;
    }

    .photo-shards {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .photo-shard {
      position: absolute;
      background-repeat: no-repeat;
      background-size: 100% 100%;
      opacity: 0;
      will-change: transform, opacity;
    }

    .final-text-block {
      padding: 12px 14px 4px;
      border-radius: 18px;
      background:
        linear-gradient(145deg,
          rgba(255, 255, 255, 0.96),
          rgba(255, 245, 255, 0.98));
      border: 1px solid rgba(255, 196, 213, 0.9);
      box-shadow:
        0 16px 32px rgba(212, 166, 204, 0.9),
        0 0 0 1px rgba(255, 255, 255, 1);
      max-width: 100%;
      text-align: left;
      display: inline-block;
      transform-origin: center;
      animation: cardPopIn 0.55s ease-out forwards;
    }

    .final-heading {
      font-size: 1rem;
      font-weight: 800;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      text-align: center;
      margin-bottom: 6px;
      color: #3a214e;
      text-shadow:
        0 0 6px rgba(255,255,255,0.9),
        0 0 12px rgba(186, 140, 199, 0.9);
      opacity: 0;
      transform: translateY(12px);
    }

    .final-date {
      font-size: 0.86rem;
      text-align: center;
      margin-bottom: 10px;
      color: #5c3b6f;
      text-shadow:
        0 0 5px rgba(255,255,255,0.8),
        0 0 10px rgba(188, 150, 205, 0.7);
      opacity: 0;
      transform: translateY(10px);
    }

    .final-caption {
      font-size: 0.9rem;
      text-align: left;
      line-height: 1.6;
      white-space: pre-wrap;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.9s ease-out, transform 0.9s ease-out;
      color: var(--text-soft);
    }

    .final-caption.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .signature {
      position: fixed;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(255, 160, 206, 0.9);
      color: #87486c;
      box-shadow:
        0 10px 20px rgba(206, 167, 200, 0.9),
        0 0 0 1px rgba(255, 255, 255, 1);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      z-index: 10;
    }

    .signature span.label {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.9;
    }

    @media (max-width: 400px) {
      .screen {
        padding: 18px 14px 60px;
        max-height: calc(100vh - 24px);
      }
      #hello-typing {
        font-size: 2.1rem;
        letter-spacing: 0.12em;
      }
      .final-photo-frame {
        max-width: 290px;
      }
    }
  </style>
</head>
<body>
  <canvas id="bg-canvas"></canvas>

  <div class="app-bg"></div>
  <div class="bg-orb orb-1"></div>
  <div class="bg-orb orb-2"></div>
  <div class="bg-orb orb-3"></div>

  <audio id="bgm" src="" loop></audio>

  <main class="app">
    <section id="screen-login" class="screen glass-panel active">
      <div class="tag">
        <span class="tag-dot"></span>
        <span>student ‚Ä¢ macOS-style login</span>
      </div>

      <div class="login-top">
        <div class="lock-emoji">üîí</div>
        <div class="login-title">ƒêƒÇNG NH·∫¨P M·ªòT L·∫¶N TRUY C·∫¨P T·∫§T C·∫¢</div>
        <div class="login-sub">M·ªü kh√≥a to√†n b·ªô ‚Äúcode‚Äù sinh nh·∫≠t H√≠u vi·∫øt cho Nga</div>
      </div>

      <div class="login-avatar">
        <div class="login-avatar-inner">TN</div>
      </div>

      <form id="login-form" autocomplete="off">
        <div class="field-group">
          <label for="login-username">T√™n ng∆∞·ªùi d√πng</label>
          <div class="input-shell" id="username-shell">
            <span class="prefix">üë§</span>
            <input
              id="login-username"
              type="text"
              placeholder="Email: Thanhnga@gmail.com"
              autocomplete="off"
            />
          </div>
        </div>

        <div id="password-wrapper" class="password-wrapper">
          <div class="field-group">
            <label for="login-password">M·∫≠t kh·∫©u</label>
            <div class="input-shell" id="password-shell">
              <span class="prefix">‚Ä¢‚Ä¢‚Ä¢</span>
              <input
                id="login-password"
                type="password"
                placeholder="Nh·∫≠p m·∫≠t kh·∫©u b√≠ m·∫≠t‚Ä¶"
              />
            </div>
          </div>
        </div>

        <div id="login-btn-wrapper" class="login-btn-wrapper">
          <button type="submit" class="btn">ƒêƒÉng nh·∫≠p</button>
        </div>

        <div id="login-error" class="error"></div>

        <p class="hint">
          T√™n ng∆∞·ªùi d√πng ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t s·∫µn l√† <strong>Thanhnga@gmail.com</strong>.<br />
          B·∫°n ch·ªâ c·∫ßn nh·∫≠p ƒë√∫ng m·∫≠t kh·∫©u <strong>‚Äú2025‚Äù</strong> ƒë·ªÉ m·ªü kh√≥a v≈© tr·ª• sinh nh·∫≠t n√†y.
        </p>
      </form>
    </section>

    <section id="screen-verify" class="screen glass-panel">
      <div class="tag">
        <span class="tag-dot"></span>
        <span>x√°c minh ‚Ä¢ student access</span>
      </div>

      <div class="mt-24">
        <div class="spinner"></div>
        <p id="verify-text" class="status-text">
          ƒêang x√°c minh th√¥ng tin, vui l√≤ng ƒë·ª£i trong gi√¢y l√°t‚Ä¶
        </p>
        <p id="verify-sub" class="status-sub">
          H·ªá th·ªëng b·∫£ng ph·∫•n & k·ªâ ni·ªám ƒëang ƒë∆∞·ª£c t·∫£i l√™n.
        </p>
      </div>
    </section>

    <section id="screen-hello" class="screen glass-panel">
      <h2 id="hello-typing"></h2>

      <div class="tap-indicator">
        <div class="tap-dot">‚¨§</div>
        <span>Ch·∫°m v√†o b·∫•t c·ª© ƒë√¢u tr√™n m√†n h√¨nh ƒë·ªÉ ti·∫øp t·ª•c</span>
      </div>
    </section>

    <section id="screen-intro" class="screen glass-panel">
      <div class="tag">
        <span class="tag-dot"></span>
        <span>birthday ‚Ä¢ active session</span>
      </div>

      <div class="intro-title">WELCOME, THANH NGA</div>

      <div id="intro-message" class="typing"></div>

      <button id="btn-to-warp" class="btn mt-24">
        B·∫Øt ƒë·∫ßu xoay chuy·ªÉn v≈© tr·ª•
      </button>
    </section>

    <section id="screen-warp" class="screen glass-panel">
      <div class="warp">
        <div class="warp-orbit">
          <div class="warp-dot"></div>
        </div>
        <h2 class="mt-16">ƒêang xoay chuy·ªÉn c·∫£ v≈© tr·ª• cho b·∫°n th√¢n üéá</h2>
        <p class="warp-sub">
          Trong v√†i gi√¢y n·ªØa, nh·ªØng th∆∞·ªõc phim tu·ªïi h·ªçc tr√≤ s·∫Ω ƒë∆∞·ª£c chi·∫øu l·∫°i
          tr√™n ‚Äúb·∫£ng ph·∫•n‚Äù d√†nh ri√™ng cho hai ƒë·ª©a.
        </p>
      </div>
    </section>

    <section id="screen-story" class="screen glass-panel">
      <div class="section-title">M·ªòT CH√öT TU·ªîI TH∆† C·ª¶A T·ª§I M√åNH</div>

      <div class="story-board-wrapper">
        <div class="story-board" id="story-board">
          <p class="story-line">
            (‚Ä¢Àï ‚Ä¢„Éû.·êü Ch√†o b·∫°n th√¢n quen c·ªßa t√¥iiii, h√¥m nay l√† sinh nh·∫≠t b·∫°n ph·∫£i kh√¥ng? H√≠u ƒë√¢y, tuy hay qu√™n nh∆∞ng ng√†y sinh nh·∫≠t c·ªßa b·∫°n v·∫´n nh·ªõ NH∆Ø IN ƒë·∫•y nh√°aaaa.
          </p>
          <p class="story-line">
            Nh√¢n d·ªãp H√≠u n√†y h·ªçc IT th√¨ h√¥m nay s·∫Ω tr·ªï t√†i ‚Äúcode‚Äù cho b·∫°n c√πng xemm lu√¥nnnn.
          </p>
          <p class="story-line">
            ·ïô(‚áÄ‚Ä∏‚Üº‚Ä∂) Tu·ªïi th∆° c·ªßa ch√∫ng ta gi·ªëng nh∆∞ m·ªôt b·ª©c tranh ƒë·ªìng qu√™ tr·∫£i d√†i v√¥ t·∫≠n, n∆°i c√°nh ƒë·ªìng l√∫a m·ªói chi·ªÅu l·∫°i t·ªèa ra m√πi th∆°m ng·ªçt d·ªãu, n∆°i gi√≥ th·ªïi qua nghe c≈©ng hi·ªÅn nh∆∞ n·ª• c∆∞·ªùi c·ªßa nh·ªØng ƒë·ª©a tr·∫ª ch·∫°y tung tƒÉng sau bu·ªïi tan h·ªçc.
          </p>
          <p class="story-line">
            V√† gi·ªØa khung c·∫£nh m·ªôc m·∫°c ·∫•y, c√≥ m·ªôt c√°i c√¢y th·ªÉ d·ª•c ƒë·ª©ng l·∫∑ng l·∫Ω nh∆∞ m·ªôt ng∆∞·ªùi b·∫°n gi√† ch·ª©ng ki·∫øn bao k·ª∑ ni·ªám. D∆∞·ªõi t√°n l√° x√≤e r·ªông ·∫•y, t·ªõ v·∫´n nh·ªõ c√°i bu·ªïi chi·ªÅu hai ƒë·ª©a ng·ªìi c·∫°nh nhau, v·ª´a n√≥i chuy·ªán v·ª´a ngh·ªãch m·∫•y chi·∫øc l√° r∆°i, k·ªÉ nhau nghe bao ƒëi·ªÅu m√† l√∫c ƒë√≥ c·ª© t∆∞·ªüng l√† chuy·ªán ‚Äúto l·∫Øm‚Äù c·ªßa tu·ªïi h·ªçc tr√≤.
          </p>
          <p class="story-line">
            ƒê·∫øn ng√†y chia tay cu·ªëi nƒÉm c·∫•p 2, t·ª•i m√¨nh l·∫°i t√¨m v·ªÅ ƒë√∫ng n∆°i ƒë√≥. C√°i b√≥ng c√¢y v·∫´n m√°t nh∆∞ c≈©, ch·ªâ c√≥ hai ƒë·ª©a l√† ƒë√£ l·ªõn th√™m m·ªôt ch√∫t, mang theo nh·ªØng c·∫£m x√∫c l·∫´n l·ªôn gi·ªØa vui v√† bu·ªìn.
          </p>
          <p class="story-line">
            Kho·∫£nh kh·∫Øc ·∫•y gi·ªëng nh∆∞ cu·ªôn phim cu·ªëi c√πng c·ªßa tu·ªïi th∆° ƒëang ƒë∆∞·ª£c tua ch·∫≠m l·∫°i ‚Äî nh·∫π nh√†ng, ·∫•m √°p v√† kh√≥ qu√™n.
          </p>
          <p class="story-line">
            V√† t·ªõ ph·∫£i n√≥i th·∫≠t ƒëi·ªÅu n√†y: Nga ch√≠nh l√† ng∆∞·ªùi ƒë√£ gieo v√†o l√≤ng t·ªõ m·ªôt tia hi v·ªçng ƒë·∫ßu ti√™n.
          </p>
          <p class="story-line">
            H·ªìi ƒë√≥ t·ªõ l√† ƒë·ª©a ch·∫≥ng ai ƒë·ªÉ √Ω, ch·∫≥ng ai r·ªß ch∆°i, l√∫c n√†o c≈©ng c·∫£m gi√°c m√¨nh b·ªã t√°ch ra kh·ªèi c·∫£ th·∫ø gi·ªõi. Nh∆∞ng Nga v·∫´n l·∫°i g·∫ßn, v·∫´n ch·ªçn xem t·ªõ l√† b·∫°n, v·∫´n l·∫Øng nghe, v·∫´n quan t√¢m ‚Äî v·ªõi t·ªõ ng√†y ·∫•y, ƒëi·ªÅu ƒë√≥ qu√Ω gi√° nh∆∞ c·∫£ b·∫ßu tr·ªùi.
          </p>
          <p class="story-line">
            C·∫£m ∆°n Nga, v√¨ ƒë√£ cho t·ªõ th·∫•y l·∫°i h√¨nh ·∫£nh ƒë·∫πp nh·∫•t c·ªßa tu·ªïi th∆°. C·∫£m ∆°n v√¨ ƒë√£ bi·∫øn c√°i tu·ªïi nh·ªè ƒë∆°n ƒë·ªôc c·ªßa t·ªõ th√†nh m·ªôt mi·ªÅn k√Ω ·ª©c c√≥ √°nh n·∫Øng, c√≥ ti·∫øng c∆∞·ªùi, v√† c√≥ m·ªôt ng∆∞·ªùi b·∫°n th·∫≠t l√≤ng.
          </p>
        </div>
      </div>

      <button id="btn-to-birthday" class="btn-ghost mt-24">
        Ti·∫øp t·ª•c h√†nh tr√¨nh k·ªâ ni·ªám
      </button>
    </section>

    <section id="screen-birthday" class="screen glass-panel">
      <div class="big-birthday">
        CH√öC M·ª™NG SINH NH·∫¨T<br />B·∫†N TH√ÇN C·ª¶A T√îI
      </div>

      <h2 class="mt-20">Nh·∫Øn g·ª≠i nh·ªè cho tu·ªïi m·ªõi ‚ú®</h2>

      <div class="blessing-card-wrapper">
        <div class="blessing-card">
          <div id="blessing-container" class="mt-16">
            <p class="blessing-line">
              Tu·ªïi m·ªõi ƒë·∫øn r·ªìi, ch√∫c ch·ªã lu√¥n v·ªØng v√†ng, m·∫°nh m·∫Ω v√† bi·∫øn m·ªçi ∆∞·ªõc m∆° c·ªßa m√¨nh th√†nh s·ª± th·∫≠t.
            </p>
            <p class="blessing-line">
              H√£y s·ªëng m·ªôt ƒë·ªùi th·∫≠t nhi·ªát huy·∫øt, th·∫≠t r·ª±c r·ª° v√† h·∫°nh ph√∫c theo c√°ch c·ªßa ri√™ng ch·ªã.
            </p>
            <p class="blessing-line">
              D√π th·∫ø gi·ªõi ngo√†i kia c√≥ ·ªìn √†o ƒë·∫øn ƒë√¢u, nh·ªõ r·∫±ng ch·ªã lu√¥n x·ª©ng ƒë√°ng ƒë∆∞·ª£c y√™u th∆∞∆°ng v√† tr√¢n tr·ªçng.
            </p>
            <p class="blessing-line">
              T·ªèa s√°ng theo c√°ch c·ªßa ch·ªã nha ‚ú® ‡¥¶‡µç‡¥¶‡¥ø(‚Ä¢Àï‚Ä¢„Éû) Em lu√¥n ·ªßng h·ªô ch·ªã!
            </p>
          </div>
        </div>
      </div>

      <button id="btn-to-final-question" class="btn mt-auto">
        Ti·∫øp t·ª•c
      </button>
    </section>

    <section id="screen-final-question" class="screen glass-panel">
      <div class="section-title">V√Ä CU·ªêI C√ôNG L√Ä‚Ä¶</div>
      <p class="final-question-text">
        Chu·∫©n b·ªã cho m·ªôt m·∫£nh gh√©p nh·ªè n·ªØa c·ªßa v≈© tr·ª• ‚Äì m·ªôt kho·∫£nh kh·∫Øc ƒë∆∞·ª£c ‚Äúƒë√≥ng bƒÉng‚Äù l·∫°i th√†nh h√¨nh ·∫£nh.
      </p>

      <button id="btn-show-final" class="btn mt-auto">
        Xem m·∫£nh gh√©p cu·ªëi c√πng
      </button>
    </section>

    <section id="screen-final-photo" class="screen glass-panel">
      <div class="section-title">Kho·∫£nh kh·∫Øc ƒë√£ ƒë∆∞·ª£c ƒë√≥ng bƒÉng</div>

      <div class="photo-stage">
        <div id="glass-webgl"></div>

        <div class="final-photo-frame">
          <div id="photo-shards" class="photo-shards"></div>
        </div>

        <div class="final-text-block mt-16">
          <div class="final-heading">
            ùô∑ùöäùöôùöôùö¢ ùô±ùöíùöõùöùùöëùöçùöäùö¢ ‚Äì Thanh Nga
          </div>
          <div class="final-date">
            ùü∂ùü∏/ùü∑ùü∏/ùü∏ùü∂ùü∂ùüΩ  ‚Ä¢  ùü∂ùü∏/ùü∑ùü∏/ùü∏ùü∂ùü∏ùü∂
          </div>
          <div id="final-caption" class="final-caption"></div>
        </div>
      </div>
    </section>
  </main>

  <div class="signature">
    <span class="label">CREATED BY H√çU</span>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://unpkg.com/@studio-freight/lenis@1.0.45/bundled/lenis.min.js"></script>
  <script src="https://unpkg.com/split-type"></script>
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script src="https://unpkg.com/@barba/core"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // === C·∫§U H√åNH LOGIN THEO Y√äU C·∫¶U ===
      const USERNAME = "Thanhnga@gmail.com";
      const PASSWORD = "2025";

      // --- C·∫§U H√åNH LINK ·∫¢NH V√Ä LINK NH·∫†C T·∫†I ƒê√ÇY ---
      const FINAL_PHOTO_URL = "https://images.unsplash.com/photo-1513151233558-d860c5398176?q=80&w=1000&auto=format&fit=crop";
      const BGM_URL = "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3";

      const bgm = document.getElementById("bgm");
      if (BGM_URL) {
        bgm.src = BGM_URL;
      }

      const screens = document.querySelectorAll(".screen");
      const getScreen = (id) => document.getElementById(id);

      function transitionScreens(fromId, toId) {
        const from = getScreen(fromId);
        const to = getScreen(toId);
        if (from) from.classList.remove("active");
        if (to) to.classList.add("active");
      }

      /* Barba.js ‚Äì init c∆° b·∫£n */
      if (window.barba) {
        barba.init({
          transitions: [{
            name: "default",
            leave() {},
            enter() {}
          }]
        });
      }

      /* Lenis ‚Äì smooth scroll */
      if (window.Lenis) {
        const lenis = new Lenis();
        function raf(time) {
          lenis.raf(time);
          requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);
      }

      /* CANVAS BACKGROUND */
      const canvas = document.getElementById("bg-canvas");
      const ctx = canvas.getContext("2d");
      let particles = [];
      let w = window.innerWidth;
      let h = window.innerHeight;

      function resizeCanvas() {
        w = window.innerWidth;
        h = window.innerHeight;
        canvas.width = w;
        canvas.height = h;
        createParticles();
      }

      function createParticles() {
        particles = [];
        const count = 40;
        for (let i = 0; i < count; i++) {
          particles.push({
            x: Math.random() * w,
            y: Math.random() * h,
            r: 10 + Math.random() * 26,
            sx: -0.15 + Math.random() * 0.3,
            sy: -0.1 + Math.random() * 0.2,
            alpha: 0.25 + Math.random() * 0.4,
            color: ["255,182,193", "255,228,196", "191,231,255"][Math.floor(Math.random() * 3)]
          });
        }
      }

      function drawParticles() {
        ctx.clearRect(0, 0, w, h);
        particles.forEach(p => {
          ctx.beginPath();
          const grd = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r);
          grd.addColorStop(0, `rgba(${p.color}, ${p.alpha + 0.15})`);
          grd.addColorStop(1, `rgba(${p.color}, 0)`);
          ctx.fillStyle = grd;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();

          p.x += p.sx;
          p.y += p.sy;

          if (p.x < -50) p.x = w + 50;
          if (p.x > w + 50) p.x = -50;
          if (p.y < -50) p.y = h + 50;
          if (p.y > h + 50) p.y = -50;
        });
        requestAnimationFrame(drawParticles);
      }

      resizeCanvas();
      drawParticles();
      window.addEventListener("resize", resizeCanvas);

      /* GSAP background orbs */
      if (window.gsap) {
        gsap.to(".bg-orb.orb-1", {
          duration: 18,
          x: 40,
          y: 20,
          scale: 1.08,
          yoyo: true,
          repeat: -1,
          ease: "sine.inOut"
        });
        gsap.to(".bg-orb.orb-2", {
          duration: 20,
          x: -40,
          y: -30,
          scale: 1.1,
          yoyo: true,
          repeat: -1,
          ease: "sine.inOut"
        });
        gsap.to(".bg-orb.orb-3", {
          duration: 22,
          x: 30,
          y: -20,
          scale: 1.06,
          yoyo: true,
          repeat: -1,
          ease: "sine.inOut"
        });
      }

      /* INPUT FOCUS + LOGIN LOGIC */
      const usernameShell = document.getElementById("username-shell");
      const passwordShell = document.getElementById("password-shell");
      const usernameInput = document.getElementById("login-username");
      const passwordInput = document.getElementById("login-password");
      const loginForm = document.getElementById("login-form");
      const passwordWrapper = document.getElementById("password-wrapper");
      const loginBtnWrapper = document.getElementById("login-btn-wrapper");
      const loginError = document.getElementById("login-error");

      usernameInput.addEventListener("focus", () => usernameShell.classList.add("focused"));
      usernameInput.addEventListener("blur", () => usernameShell.classList.remove("focused"));
      passwordInput.addEventListener("focus", () => passwordShell.classList.add("focused"));
      passwordInput.addEventListener("blur", () => passwordShell.classList.remove("focused"));

      // === PH∆Ø∆†NG √ÅN 2: EMAIL C·ªê ƒê·ªäNH, CH·ªà C·∫¶N NH·∫¨P PASSWORD ===
      usernameInput.value = USERNAME;
      usernameInput.readOnly = true;
      usernameInput.style.opacity = "0.85";

      // lu√¥n hi·ªán √¥ m·∫≠t kh·∫©u
      passwordWrapper.classList.add("visible");

      // Hi·ªán / ·∫©n n√∫t login theo password
      passwordInput.addEventListener("input", function () {
        const val = this.value.trim();
        if (val.length > 0) {
          if (!loginBtnWrapper.classList.contains("visible")) {
            loginBtnWrapper.classList.add("visible");
            if (window.gsap) {
              gsap.fromTo("#login-btn-wrapper",
                { y: 10, opacity: 0 },
                { y: 0, opacity: 1, duration: 0.3 }
              );
            }
          }
        } else {
          loginBtnWrapper.classList.remove("visible");
        }
      });

      let isCorrectCredentials = false;

      loginForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const p = passwordInput.value.trim();

        if (!p) {
          loginError.textContent = "Nh·∫≠p m·∫≠t kh·∫©u n·ªØa nha ~";
          return;
        }
        if (p !== PASSWORD) {
          loginError.textContent = "M·∫≠t kh·∫©u sai r·ªìi nh√©, th·ª≠ l·∫°i xem (‚ï•·Ü∫‚ï•Ôºõ)!";
          return;
        }

        loginError.textContent = "";
        isCorrectCredentials = true;

        // Login ƒë√∫ng -> b·∫≠t nh·∫°c
        if (isCorrectCredentials && bgm) {
          bgm.volume = 0.8;
          bgm.play().catch(() => console.log("C·∫ßn t∆∞∆°ng t√°c ƒë·ªÉ ph√°t nh·∫°c"));
        }

        if (window.gsap) {
          gsap.to("#screen-login", {
            duration: 0.4,
            y: -20,
            opacity: 0,
            ease: "power2.inOut",
            onComplete: () => {
              transitionScreens("screen-login", "screen-verify");
              startVerify();
            }
          });
        } else {
          transitionScreens("screen-login", "screen-verify");
          startVerify();
        }
      });

      /* VERIFY */
      const verifyText = document.getElementById("verify-text");
      const verifySub = document.getElementById("verify-sub");

      function startVerify() {
        verifyText.textContent = "ƒêang x√°c minh th√¥ng tin, vui l√≤ng ƒë·ª£i trong gi√¢y l√°t‚Ä¶";
        verifySub.textContent = "H·ªá th·ªëng b·∫£ng ph·∫•n & k·ªâ ni·ªám ƒëang ƒë∆∞·ª£c t·∫£i l√™n.";

        setTimeout(() => {
          verifyText.textContent = "ƒêƒÉng nh·∫≠p th√†nh c√¥ng ‚úÖ";
          verifySub.textContent = "Chu·∫©n b·ªã m·ªü kh√≥a th·∫ø gi·ªõi nh·ªè c·ªßa hai ƒë·ª©a.";

          setTimeout(() => {
            startHelloScreen();
            transitionScreens("screen-verify", "screen-hello");
          }, 1300);
        }, 5000);
      }

      /* HELLO */
      const helloScreen = document.getElementById("screen-hello");
      const helloTyping = document.getElementById("hello-typing");

      const helloList = [
        { primary: "Hello", secondary: "Thanh Nga" },
        { primary: "Xin ch√†o", secondary: "Thanh Nga" },
        { primary: "Hola", secondary: "Thanh Nga" },
        { primary: "Bonjour", secondary: "Thanh Nga" },
        { primary: "Ciao", secondary: "Thanh Nga" },
        { primary: "ÏïàÎÖïÌïòÏÑ∏Ïöî", secondary: "Thanh Nga" },
        { primary: "Konnichiwa", secondary: "Thanh Nga" },
        { primary: "Welcome", secondary: "b·∫°n th√¢n c·ªßa H√≠u ‚ú®" },
      ];

      let helloLoopStarted = false;

      function typeHello(item, callback) {
        const fullText = item.secondary
          ? item.primary + "\n" + item.secondary
          : item.primary;

        helloTyping.classList.remove("fade-out");
        helloTyping.classList.add("fade-in");
        helloTyping.innerHTML = "";

        let i = 0;
        const interval = setInterval(() => {
          const current = fullText.slice(0, i);
          helloTyping.innerHTML = current.replace(/\n/g, "<br>");
          i++;

          if (i > fullText.length) {
            clearInterval(interval);
            setTimeout(() => {
              helloTyping.classList.remove("fade-in");
              helloTyping.classList.add("fade-out");
              setTimeout(callback, 500);
            }, 900);
          }
        }, 60);
      }

      function startHelloScreen() {
        if (helloLoopStarted) return;
        helloLoopStarted = true;
        let index = 0;

        function next() {
          typeHello(helloList[index], () => {
            index = (index + 1) % helloList.length;
            next();
          });
        }
        next();
      }

      helloScreen.addEventListener("click", () => {
        startIntroMessage();
        transitionScreens("screen-hello", "screen-intro");
      });

      /* INTRO MESSAGE */
      const introEl = document.getElementById("intro-message");
      const btnToWarp = document.getElementById("btn-to-warp");

      const introText =
        "‡¥¶‡µç‡¥¶‡¥ø ÀâÕàÃÄÍí≥ÀâÕàÃÅ )‚úß Welcome ng∆∞·ªùi con g√°i tuy·ªát v·ªõi Today ! " +
        "H√¥m nay, v≈© tr·ª• mu·ªën g·ª≠i th√¥ng ƒëi·ªáp ‚ñ†‚ñ†‚ñ†‚ñ† ƒë·∫øn cho b·∫°n, " +
        "h√£y Make Them Yours nh√©eeeeeeee.";

      function typeText(element, text, speed, callback) {
        element.innerHTML = "";
        let i = 0;
        const spanCaret = document.createElement("span");
        spanCaret.className = "caret";
        const interval = setInterval(() => {
          element.textContent = text.slice(0, i);
          element.appendChild(spanCaret);
          i++;
          if (i > text.length) {
            clearInterval(interval);
            if (callback) callback();
          }
        }, speed);
      }

      function startIntroMessage() {
        typeText(introEl, introText, 28, () => {});
      }

      btnToWarp.addEventListener("click", () => {
        transitionScreens("screen-intro", "screen-warp");
        startWarpGsap();
        setTimeout(() => {
          transitionScreens("screen-warp", "screen-story");
          playStoryTyping();
        }, 10000);
      });

      /* WARP GSAP */
      function startWarpGsap() {
        if (!window.gsap) return;
        const tl = gsap.timeline({ repeat: 0 });

        tl.fromTo(".warp-orbit", {
          scale: 0.9,
          rotation: -10,
          filter: "blur(0px)"
        }, {
          duration: 5,
          scale: 1.08,
          rotation: 10,
          filter: "blur(3px)",
          ease: "sine.inOut"
        }).to(".warp-orbit", {
          duration: 5,
          scale: 1,
          rotation: 0,
          filter: "blur(0px)",
          ease: "sine.inOut"
        }, "+=0");
      }

      /* STORY */
      const storyBoard = document.getElementById("story-board");
      const storyLines = Array.from(
        storyBoard.querySelectorAll(".story-line")
      );
      const btnToBirthday = document.getElementById("btn-to-birthday");

      const storyOriginalTexts = storyLines.map(p => p.textContent.trim());

      function playStoryTyping() {
        storyLines.forEach(p => p.textContent = "");
        if (window.gsap) {
          gsap.fromTo("#story-board", {
            scale: 0.97,
            y: 12,
            opacity: 0
          }, {
            duration: 0.7,
            scale: 1,
            y: 0,
            opacity: 1,
            ease: "power2.out"
          });
        }

        let index = 0;
        function typeLine() {
          if (index >= storyLines.length) return;
          const el = storyLines[index];
          const full = storyOriginalTexts[index];
          let i = 0;
          const speed = 24;

          const interval = setInterval(() => {
            el.textContent = full.slice(0, i);
            i++;
            if (i > full.length) {
              clearInterval(interval);
              index++;
              setTimeout(typeLine, 350);
            }
          }, speed);
        }
        typeLine();
      }

      btnToBirthday.addEventListener("click", () => {
        transitionScreens("screen-story", "screen-birthday");
        playBlessings();
      });

      /* BLESSING */
      const blessingContainer = document.getElementById("blessing-container");
      const blessingLines = Array.from(
        blessingContainer.querySelectorAll(".blessing-line")
      );
      const btnToFinalQuestion = document.getElementById("btn-to-final-question");

      function playBlessings() {
        blessingLines.forEach((line) => line.classList.remove("visible"));
        blessingLines.forEach((line, i) => {
          setTimeout(() => {
            line.classList.add("visible");
          }, i * 900);
        });

        if (window.gsap) {
          gsap.fromTo("#screen-birthday .big-birthday", {
            scale: 0.95,
            y: 10,
            opacity: 0
          }, {
            duration: 0.6,
            scale: 1,
            y: 0,
            opacity: 1,
            ease: "back.out(1.7)"
          });
        }
      }

      btnToFinalQuestion.addEventListener("click", () => {
        transitionScreens("screen-birthday", "screen-final-question");
      });

      /* FINAL QUESTION & PHOTO */
      const btnShowFinal = document.getElementById("btn-show-final");
      const photoShardsContainer = document.getElementById("photo-shards");
      const finalCaptionEl = document.getElementById("final-caption");

      const finalText =
`Big thanks v√¨ b·∫°n ƒë√£ d√†nh nh·ªØng thanh xu√¢n tu·ªïi h·ªçc tr√≤ cho H√≠u. M√¨nh r·∫•tttt Appreciate ƒëi·ªÅu ƒë√≥ >‚©ä<

Ch·ªâ mong r·∫±ng, kh√¥ng ch·ªâ h√¥m nay m√† m·ªói ng√†y tr√¥i qua, cu·ªôc s·ªëng c·ªßa you ƒë·ªÅu ƒë∆∞·ª£c l·∫•p ƒë·∫ßy b·ªüi nh·ªØng happy vibes v√† nh·ªØng kho·∫£nh kh·∫Øc unforgettable.

Happy Birthday! üéÇ Thanh Nga nh√©ee, tu·ªïi 18‚Ä¶ nghe th√¥i l√† ƒë√£ th·∫•y c·∫£ m·ªôt b·∫ßu tr·ªùi trong veo m·ªü ra tr∆∞·ªõc m·∫Øt r·ªìi. Tu·ªïi 18 l√† l√∫c ng∆∞·ªùi ta v·ª´a ƒë·ªß l·ªõn ƒë·ªÉ hi·ªÉu m√¨nh mu·ªën g√¨, nh∆∞ng v·∫´n c√≤n ƒë·ªß tr·∫ª ƒë·ªÉ m∆° nh·ªØng gi·∫•c m∆° th·∫≠t r·ªông. N√≥ ƒë·∫πp nh∆∞ kho·∫£nh kh·∫Øc b√¨nh minh, d·ªãu d√†ng, trong s√°ng nh∆∞ng ƒë·∫ßy h·ª©a h·∫πn.

V√† trong ng√†y ƒë·∫∑c bi·ªát n√†y, H√≠u th·∫≠t l√≤ng ch√∫c Nga s·∫Ω b∆∞·ªõc v√†o tu·ªïi m·ªõi v·ªõi m·ªôt tr√°i tim nh·∫π nh√†ng nh∆∞ng ki√™n ƒë·ªãnh. Mong r·∫±ng m·ªçi hi v·ªçng Nga gieo xu·ªëng ƒë·ªÅu n·∫£y m·∫ßm, m·ªçi ∆∞·ªõc m∆° Nga g·ª≠i v√†o t∆∞∆°ng lai ƒë·ªÅu c√≥ ng√†y n·ªü hoa.

Con ƒë∆∞·ªùng ph√≠a tr∆∞·ªõc c√≥ th·ªÉ kh√¥ng ph·∫£i l√∫c n√†o c≈©ng b·∫±ng ph·∫≥ng‚Ä¶ s·∫Ω c√≥ nh·ªØng h√¥m m·ªát, c√≥ nh·ªØng ng√†y kh√¥ng ai hi·ªÉu, v√† c√≥ nh·ªØng kho·∫£nh kh·∫Øc mu·ªën b·ªè cu·ªôc.

Nh∆∞ng H√≠u tin r·∫±ng, ch·ªâ c·∫ßn Nga gi·ªØ ƒë∆∞·ª£c ni·ªÅm tin v√† s·ª± ·∫•m √°p trong m√¨nh, th√¨ m·ªçi th·ª≠ th√°ch r·ªìi c≈©ng s·∫Ω nh∆∞·ªùng b∆∞·ªõc. C·ª© ƒë·ª©ng d·∫≠y, h√≠t m·ªôt h∆°i th·∫≠t s√¢u v√† ƒëi ti·∫øp. T∆∞∆°ng lai ƒë·∫πp nh·∫•t lu√¥n n·∫±m sau nh·ªØng l·∫ßn m√¨nh kh√¥ng b·ªè cu·ªôc.

Ch√∫c Nga tu·ªïi 18 th·∫≠t r·ª±c r·ª°, th·∫≠t h·∫°nh ph√∫c, v√† lu√¥n t√¨m th·∫•y √°nh s√°ng c·ªßa ri√™ng m√¨nh tr√™n h√†nh tr√¨nh ph√≠a tr∆∞·ªõc üéâ‚ú®`;

      function createPhotoShards() {
        photoShardsContainer.innerHTML = "";
        const rows = 4;
        const cols = 6;

        for (let r = 0; r < rows; r++) {
          for (let c = 0; c < cols; c++) {
            const shard = document.createElement("div");
            shard.className = "photo-shard";
            const w = 100 / cols;
            const h = 100 / rows;
            shard.style.width = w + "%";
            shard.style.height = h + "%";
            shard.style.left = (c * w) + "%";
            shard.style.top = (r * h) + "%";
            shard.style.backgroundImage = `url("${FINAL_PHOTO_URL}")`;
            shard.style.backgroundPosition = `${(-c * w)}% ${(-r * h)}%`;
            shard.style.backgroundSize = `${cols * 100}% ${rows * 100}%`;

            photoShardsContainer.appendChild(shard);
          }
        }
      }

      btnShowFinal.addEventListener("click", () => {
        transitionScreens("screen-final-question", "screen-final-photo");

        createPhotoShards();
        initGlassWebGL();

        if (window.gsap) {
          const shards = document.querySelectorAll(".photo-shard");
          shards.forEach((shard) => {
            const angle = (Math.random() - 0.5) * 120;
            const dx = (Math.random() - 0.5) * 200;
            const dy = (Math.random() - 0.5) * 200;
            gsap.set(shard, {
              opacity: 0,
              x: dx,
              y: dy,
              rotation: angle,
              scale: 0.8
            });
          });

          gsap.to(".photo-shard", {
            duration: 0.9,
            opacity: 1,
            x: 0,
            y: 0,
            rotation: 0,
            scale: 1,
            ease: "expo.out",
            stagger: 0.02
          });
        }

        finalCaptionEl.textContent = finalText;

        const headingEl = document.querySelector(".final-heading");
        const dateEl = document.querySelector(".final-date");

        if (window.SplitType && window.gsap) {
          try {
            const titleSplit = new SplitType(headingEl, { types: "chars" });
            const dateSplit = new SplitType(dateEl, { types: "chars" });

            gsap.fromTo(titleSplit.chars, {
              opacity: 0,
              y: 24,
              scale: 0.9
            }, {
              opacity: 1,
              y: 0,
              scale: 1,
              duration: 0.9,
              ease: "power3.out",
              stagger: 0.03
            });

            gsap.fromTo(dateSplit.chars, {
              opacity: 0,
              y: 12
            }, {
              opacity: 1,
              y: 0,
              duration: 0.7,
              ease: "power2.out",
              stagger: 0.02,
              delay: 0.1
            });
          } catch(err) {
             headingEl.style.opacity = 1;
             dateEl.style.opacity = 1;
          }
        } else if (window.gsap) {
          gsap.to(headingEl, { opacity: 1, y: 0, duration: 0.7 });
          gsap.to(dateEl, { opacity: 1, y: 0, duration: 0.6, delay: 0.1 });
        } else {
          headingEl.style.opacity = 1;
          dateEl.style.opacity = 1;
        }

        setTimeout(() => {
          finalCaptionEl.classList.add("visible");
        }, 400);
      });

      /* Three.js + GLSL ‚Äì n·ªÅn glass ƒë·ªông ·ªü trang cu·ªëi */
      function initGlassWebGL() {
        const container = document.getElementById("glass-webgl");
        if (!container || !window.THREE) return;
        if (container.dataset.init === "1") return;
        container.dataset.init = "1";

        const width = container.clientWidth;
        const height = container.clientHeight;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(width, height);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        const scene = new THREE.Scene();
        const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);

        const geometry = new THREE.PlaneGeometry(2, 2);

        const uniforms = {
          uTime: { value: 0.0 },
          uResolution: { value: new THREE.Vector2(width, height) }
        };

        const vertexShader = `
          varying vec2 vUv;
          void main(){
            vUv = uv;
            gl_Position = vec4(position, 1.0);
          }
        `;

        const fragmentShader = `
          precision highp float;
          varying vec2 vUv;
          uniform float uTime;
          uniform vec2 uResolution;

          float hash(vec2 p){
            return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453123);
          }

          float noise(in vec2 p){
            vec2 i = floor(p);
            vec2 f = fract(p);

            float a = hash(i);
            float b = hash(i + vec2(1.0, 0.0));
            float c = hash(i + vec2(0.0, 1.0));
            float d = hash(i + vec2(1.0, 1.0));

            vec2 u = f * f * (3.0 - 2.0 * f);

            return mix(a, b, u.x) +
                   (c - a)* u.y * (1.0 - u.x) +
                   (d - b) * u.x * u.y;
          }

          void main(){
            vec2 uv = vUv;
            vec2 p = uv * 3.0;

            float t = uTime * 0.25;

            float n1 = noise(p + vec2(t, 0.0));
            float n2 = noise(p * 1.6 - vec2(0.0, t * 1.2));
            float n3 = noise(p * 2.3 + vec2(t * 0.7, t * 0.5));

            float glass = n1 * 0.5 + n2 * 0.3 + n3 * 0.2;

            float highlight = smoothstep(0.45, 0.9, glass);

            vec3 col1 = vec3(1.0, 0.83, 0.96);
            vec3 col2 = vec3(0.80, 0.93, 1.0);
            vec3 col3 = vec3(1.0, 0.95, 0.82);

            vec3 base = mix(col1, col2, n2);
            base = mix(base, col3, n3);

            vec2 center = vec2(0.5, 0.3 + 0.1 * sin(uTime * 0.7));
            float d = distance(uv, center);
            float glow = smoothstep(0.6, 0.0, d) * 0.6;

            vec3 color = base + glow * vec3(1.0, 0.9, 1.0);
            color += highlight * 0.18;

            float alpha = 0.85;

            gl_FragColor = vec4(color, alpha);
          }
        `;

        const material = new THREE.ShaderMaterial({
          uniforms,
          vertexShader,
          fragmentShader,
          transparent: true
        });

        const mesh = new THREE.Mesh(geometry, material);
        scene.add(mesh);

        function onResize() {
          const w2 = container.clientWidth;
          const h2 = container.clientHeight;
          renderer.setSize(w2, h2);
          uniforms.uResolution.value.set(w2, h2);
        }
        window.addEventListener("resize", onResize);

        const clock = new THREE.Clock();

        function animate() {
          uniforms.uTime.value += clock.getDelta();
          renderer.render(scene, camera);
          requestAnimationFrame(animate);
        }
        animate();
      }
    });
  </script>
</body>
</html>
